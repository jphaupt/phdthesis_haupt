\chapter{Introduction}
\label{chap:intro}

According to modern quantum theory, to fully describe\footnote{This neglects relavistic effects.} a system of $N_A$ atoms and $N_e$ electrons, we must solve the time-dependent Schr\"odinger equation,
\begin{equation}
    \label{eq:schrodinger}
    i \hbar \frac{\partial}{\partial t} \Psi(\bm{x}, t)
    = \hat{H} \Psi(\bm{x}, t)
\end{equation}
where $\bm x=(\bm{r}, \sigma)$, $\bm r\in\mathcal{R}^{3(N_e+N_A)}$ gives the spatial coordinates, and $\sigma$ the corresponding spins. For atoms with atomic numbers $Z_I$ (positive charge $Ze$), and with $N_e=ZN_A$, the Hamiltonian operator $\hat H$ may be written

\begin{align}
\begin{split}
\label{eq:theory_of_everything}
\hat H =& -\sum_{I=1}^{N_A}\frac{\hbar^2}{2m_I} \nabla^2_I
+ \frac 1{4\pi\epsilon_0} \frac 12\sum_{I,J=1;I\neq J}^{N_A} \frac{Z_IZ_Je^2}{|\bm R_I-\bm R_J|} \\
&- \sum_{i=1}^{N_e} \frac{\hbar^2}{2m_e} \nabla^2_i
+ \frac 1{4\pi\epsilon_0} \frac 12\sum_{i,j=1;i\neq j}^{N_e} \frac{e^2}{|\bm r_i-\bm r_j|}
- \sum_{i=1}^{N_e} \sum_{I=1}^{N_A} \frac{Z_I e^2}{|\bm r_i-\bm R_I|}
\end{split}
\end{align}
where we have represented the nuclear coordinates by $\bm R_I$ and the electron coordinates by $\bm r_i$.

Since quantum chemistry and condensed matter sciences are in general concerned with nonrelativistic processes involving electrons and nuclei, this might be called the \emph{theory of everything}. Hence, we may be tempted to conclude this dissertation early, but in practice the evaluation of the Hamiltonian \eqref{eq:theory_of_everything} is impossible. First, there is no closed form solution of \eqref{eq:schrodinger} with this Hamiltonian. Second, numerical evaluation of $\hat H$ is far from trivial.

Let's consider a simple example, the Argon atom. Say we want to solve this partial differential equation on a grid. Let's choose a simple, coarse $100\times 100\times 100$ grid. Then \emph{at each time step} we need to store $(100^3)^{23}=10^{138}$ values, corresponding to all the particle positions and the grid. Considering there are ``only'' $\sim 10^{80}$ atoms in the known universe,\cite{rydenIntroduction2017} this is quite a tall order!

This system has only 18 electrons and 18 nuclei, a farcry from the $10^{23}$ or higher number of electrons in a typical condensed matter system, for example. Moreover, we have not taken into account floating point precision, or that we would need to calculate this for possibly many time steps. Clearly, drastic approximations and more sophisticated methods are required.

\section{Overview of the Thesis}

This dissertation fits into the field of nonrelativistic electronic structure theory, the branch of quantum chemistry concerned with the description of electrons and their correlation inside molecules and materials. More specifically, this dissertation focuses on high-accuracy (but often high-cost) \emph{ab initio} methodologies, especially \gls{FCIQMC} and \gls{TC}. As such, we will only be discussing small systems of consisting of only a few atoms, as they are tractible with a full, all-electron treatment with these methods. In principle, these methods should be able to be embedded \todo{embedding citation(s)} into more large-scale calculations using multiscale techniques, but this is outside the scope of my work. Nevertheless, the work herein is focused on methodologies, and not on particular physical systems.

The outline of the dissertation is as thus:
\begin{itemize}
    \item Chapter \ref{chap:intro} (this chapter) provides a basic overview of electronic structure theory methods and some of its principal concepts. Sections \ref{sec:hf} and \ref{sec:post-hf} in particular are largely based on the appropriate chapters of Ref \citenum{helgakerMolecular2014}.
    \item Chapter \ref{chap:explicit} reviews the current works in so-called ``explicitly correlated'' methods, notably the well-established R12/F12 and the recently-reinvigorated \gls{TC}.
    \item Chapter \ref{chap:qmc} provides a basic introduction to \gls{QMC} and how it relates to \gls{FCIQMC}.
    \item Chapter \ref{chap:opt} discusses optimization of Jastrow factors in the context of \gls{TC}.
    \item Chapter \ref{chap:binding} discusses an extension of the methods in the previous chapters to ensure size consistency and success when targeting strongly multi-reference problems.
    \item Chapter \ref{chap:pytchint} provides an overview of the software \pytchint developed in the group for evaluation of \gls{TC} integrals.
    \item Finally, chapter \ref{chap:sumandout} provides a review and an outlook for the field.
\end{itemize}


\section{Principal Approximations}

As discussed, to make any progress in electronic structure theory, we must make use of approximations. Of course, we must always be cautious and suspicious when using these, and make sure they are valid for the systems in question. Thankfully, over the course of the last century, a cornucopia of different approximations have been developed to tackle the Schr\"odinger question, some of which will be discussed in this section.

\subsection{The Born-Oppenheimer Approximation}

The most important approximation used in electronic structure theory is the \gls{BOA}.\cite{bornZur1927} The \gls{BOA} relies on the fact that the nuclei are much heavier than the electrons, with the mass of a single proton being almost 2000 times the mass of an electron. As an intuitive picture, we may think of the nuclei as moving much slower than the electrons, which can adapt themselves to the instantaneous positions of the nuclei. In mathematical terms, this means we can take the total wave function to be a product of its nuclear and electronic components,
\begin{equation}
    \Psi_\mathrm{total} = \Psi_\mathrm{nuc} \Psi_\mathrm{elec}.
\end{equation}

Notice that the first two terms of \eqref{eq:theory_of_everything} are independent of the electronic coordinates and, ipso facto, have no effect on $\Psi_\mathrm{elec}$. This leads to the \emph{electronic Hamiltonian} under the \gls{BOA}, which can be written in atomic units as
\begin{equation}
\label{eq:elec_hamiltonian}
\hat H_\mathrm{elec} = -\sum_{i} \frac{1}{2} \nabla_i^2 - \sum_{i,I} \frac{Z_I}{r_{iI}} + \sum_{i\gt j} \frac{1}{r_{ij}},
\end{equation}
where we have simplified notation by using miniscule roman letters for the electrons and capital roman letters for the nuclei, and $r_{ij}=|\mathbf{r}_i-\mathbf{r}_j|$ and $r_{iI}=|\mathbf{r}_i-\mathbf{R}_I|$.

In the language of second quantisation, equation \eqref{eq:elec_hamiltonian} can be written as
\begin{equation}
\label{eq:elec_hamiltonian_2q}
\hat H_\mathrm{elec} = \sum_{ij\sigma} h_{ij}a_{i\sigma}^\dag a_{j\sigma}+\frac 12 \sum_{ijkl\sigma\tau} V_{ijkl}a_{i\sigma}^\dag a_{j\tau}^\dag a_{k\tau}a_{l\sigma},
\end{equation}
where $\sigma,\tau\in\{\uparrow,\downarrow\}$ are spin indices, and $a_{i\sigma}$ ($a_{i\sigma}^\dag$) is the annihilation (creation) operator for an electron on spin-orbital $i$ with spin $\sigma$. These must obey the anti-commutation relation
\begin{equation}
    \{a_{i\sigma},a_{j\tau}^\dag\}
    \mathdef
    a_{i\sigma}a_{j\tau}^\dag + a_{j\tau}^\dag a_{i\sigma}
    =\delta_{ij}\delta_{\sigma\tau}
\end{equation}
so that the electrons satisfy the Pauli exclusion principle.

In equation \ref{eq:elec_hamiltonian_2q}, $h_{ij}$ is a one-body integral,
\begin{equation}
\label{eq:hij}
h_{ij} = \int \phi_i^*(\mathbf{r})\left(-\frac 12 \nabla^2 - \sum_I \frac{Z_I}{|\mathbf{R}_I-\mathbf r|}\right)\phi_j(\mathbf{r})\mathrm{d}\mathbf{r}
\end{equation}
and $g_{ijkl}$ is a two-body integral,
\begin{equation}
V_{ijkl} = \int \phi_i^*(\mathbf{r})\phi_k^*(\mathbf{r}')\frac{1}{|\mathbf{r}-\mathbf{r}'|}\phi_j(\mathbf{r}')\phi_l(\mathbf{r})\mathrm{d}\mathbf{r}\mathrm{d}\mathbf{r}',
\end{equation}
with a spatial-orbital basis $\{\phi_i(\mathbf{r})\}$.

Finally, to treat the nuclear Hamiltonian, we neglect the first term of equation \eqref{eq:theory_of_everything}, and treat the second term as approximately constant, so $\hat H_\mathrm{nuc} = \sum_{IJ} Z_IZ_Jr_{IJ}$. Thus, we are left with the problem of solving the electronic structure problem, which is the subject of this dissertation.

Note that while chemists and physicists typically talk about the positions of nuclei in a molecule or solid as if they are fixed in place, as will be done in this dissertation, this is really a colloquialism. If the nuclei had an exact position and zero kinetic energy, the \gls{BOA} would, ipso facto, be in direct contradiction of the Heisenberg uncertainty principle. Instead, on the timescale of the electrons, due to the much higher mass of nuclei, in the \gls{BOA} we treat the nuclei as approximately localised in a state in which their motion is much slower than that of the electrons (but, importantly, not zero). This keeps the approximation from being in conflict with the fundamental postulates of quantum theory.

The \gls{BOA} is an immensely practical tool as it substantially simplifies our equations, and in many applications it is an excellent approximation. It will be a fundamental assumption throughout the rest of this dissertation, though it need not always be valid in all of quantum chemistry.

While we have done a lot to drastically reduce the complexity of equation \eqref{eq:theory_of_everything}, equation \eqref{eq:elec_hamiltonian_2q} is still intractible for large system sizes, scaling combinatorially with the size of the Hilbert space, as function of the system size $N_e$ (henceforth $N$), and the basis set size $M$. Hence, in addition to using a smaller basis, we still need extra approximations and sophisticated methodologies.


\subsection{Core Electrons}
\label{sec:core_electrons}

In the ground state of a single atom, electrons first occupy the lowest orbitals. The first occupied shells are typically where the electrons are the most tightly bound.\footnote{This neglects symmetries: energy may be higher due to the angular momentum while staying spatially closer to the nucleus.}

Since they tend to be further from the nucleus in an atom, the valence (non-core) electrons are typically the most affected by the introduction of additional atoms in the system. It is therefore often the valence electrons that are most important in chemical systems. For this reason, we sometimes ``freeze'' the core electrons in their respective orbitals, and only correlate the valence electrons.

Similarly, we may also delete virtual orbitals, typically those of high energy, to further reduce the size of the problem. The remaining space is known as an active space, and is the basic idea of the \gls{CAS} methods.

\subsection{Model Hamiltonians}

In 1929, the surrealist artist Ren\'e Magritte displayed a now-famous painting of a pipe with the caption \emph{Ceci n'est pas une pipe} (French for ``This is note a pipe''). It was meant to depict the idea that the painting itself is in a way treacherous: it may appear to be a pipe, but you cannot stuff it or smoke from it, as it is a representation of a pipe.

In a similar way, physicists and chemists often use \emph{model Hamiltonians}, which do away with aspects of equation \eqref{eq:theory_of_everything} that are not expected to be relevant to the problem at hand, resulting in new Hamiltonians that may be considered a representation of equation \eqref{eq:theory_of_everything}, much like Magritte's painting.\footnote{We might further argue that all of science can be described this way, as scientific models are always ``mere'' representations of Nature, and is not Nature itself.} Compared to \emph{ab initio} Hamiltonians like equation \eqref{eq:elec_hamiltonian_2q}, model Hamiltonians are generally much simpler, but depend on parameters whose values we may not necessarily know a priori.

The most famous model Hamiltonian is the Hubbard model,\cite{Hubbard1963} most typically used to describe electrons in a periodic lattice, and can be written as
\begin{equation}
\label{eq:hubbard}
\hat H_\mathrm{Hubb} = - \sum_{<i,j>\sigma} t_{ij} a_{j\sigma}^\dag a_{i\sigma} + \sum_i U_in_{i\uparrow}n_{i\downarrow},
\end{equation}
where $<i,j>$ denotes nearest neighbours, $t_{ij}$ (often taken to be constant, $t$) is a parameter called the hopping amplitude, and $U_i$ (often taken to be constant, $U$) is a parameter called the on-site repulsion.

Despite its apparent simplicity, the Hubbard model is a rich model, and has been used to describe a variety of phenomena, from metal-insulator transitions to high-temperature superconductivity. Moreover, it is not always so simple to solve, and has been the subject of much research.\cite{Lieb1968a,liebermannFCIQMC2023}

Let's consider an especially simple version of the model, with only two sites, and open boundary conditions:
\begin{equation}
\label{eq:hubbard_h2}
\hat H_\mathrm{Hubb} = - t\sum_{\sigma}(a_{1\sigma}^\dag a_{2\sigma} + a_{2\sigma}^\dag a_{1\sigma}) + U(n_{1\uparrow}n_{1\downarrow}+n_{2\uparrow}n_{2\downarrow}).
\end{equation}
We could use this as an approximate description of the H$_2$ molecule, where the electrons are restricted to only the lowest 1s orbitals. Compared to \eqref{eq:theory_of_everything}, this is a tremendously easy problem now.

Of course, when solving a problem using a model Hamiltonian, we must be careful in choosing the correct one. In particular, the exact solution to the Hubbard model in one dimension\cite{Lieb1968a} does not appear to be in agreement with the \emph{ab initio} solution of a one-dimensional chain of hydrogen atoms.\cite{Motta2017,Motta2020}

\section{The Variational Principle}
\label{sec:variational_principle}

One way of finding approximations to the lowest energy eigenstate of a quantum problem like that of equation \eqref{eq:elec_hamiltonian_2q} is the variational method. Several methods discussed in this dissertation build on the variational method, and the variational method itself is based on the variational principle, which states\cite{sakuraiModern2017} for any ``trial wave function'' $\ket{\tilde\Psi}$,
\begin{equation}
    \label{eq:variational_principle}
    \frac{\bra{\tilde\Psi}\hat H\ket{\tilde\Psi}}{\braket{\tilde\Psi}}
    \ge E_0 \mathdef  \frac{\bra{\Psi}\hat H\ket{\Psi}}{\braket{\Psi}}
\end{equation}
where $E_0$ is the exact energy. That is, the energy of $\ket{\tilde\Psi}$ is an upper bound of the exact energy of the system.

To prove this, consider an expansion of $\ket{\tilde\Psi}$ terms of the exact eigenkets $\ket k$ of $\hat H$, so that $\hat H\ket k = E_k\ket k$ and $\ket{\tilde\Psi}=\sum_kc_k\ket k$. Then
\begin{align}
\label{eq:var_proof}
    \begin{split}
    \frac{\bra{\tilde\Psi}\hat H\ket{\tilde\Psi}}{\braket{\tilde\Psi}}
    &=
    \frac{\sum_{kk'}c_k^*c_{k'}\bra{k}\hat H\ket{k'}}{\sum_{kk'}\bra{k}\ket{k'}c_k^*c_{k'}}\\
    &= \frac{\sum_k|c_k|^2(E_k-E_0)}{\sum_k|c_k|^2} + E_0 \\
    &\ge E_0
\end{split}
\end{align}
where, in going from the first to the second line, we used the orthonormality of the eigenbasis $\{\ket k\}$ and that the left- and right-eigenvectors are the same. That is, we used the fact the $\hat H$ is a Hermitian operator. This is an important observation for future discussions, such as in section \ref{sec:tc}.

\section{The Schr\"odinger Equation as a Matrix Problem}
\label{sec:matrix}

Implicit in the operator algebra of the fermionic creation and annihilation operators $a$ and $a^\dag$ in equation \eqref{eq:elec_hamiltonian_2q} is the Pauli exclusion principle: we cannot have two or more fermions occupying identical states. In the context of electronic structure theory and this dissertation, the fermions and states in question are electrons and orbitals, respectively. This handles the antisymmetry requirement of the fermionic wave function, $\hat P_{ij}^\sigma\Psi = -\Psi$, where $\hat P_{ij}^\sigma$ permutes the $i$th and $j$th electrons with spin $\sigma$.

Our wave function can hence by expanded by a linear combination of \glspl{SD},
\begin{equation}
    \label{eq:SD_expansion}
\Psi = \sum_i c_i \ket{D_i},
\quad \text{where } \ket{D_i} =
\frac 1{\sqrt{N!}}\left|
    \begin{matrix}
        \chi_1(\bm x_1) & \chi_1(\bm x_2) & \cdots & \chi_1(\bm x_N)\\
        \chi_2(\bm x_1) & \chi_2(\bm x_2) & \cdots & \chi_2(\bm x_N)\\
        \vdots & \vdots & \ddots & \vdots\\
        \chi_N(\bm x_1) & \chi_N(\bm x_2) & \cdots & \chi_N(\bm x_N)\\
    \end{matrix}
 \right|
\end{equation}
for a spin-orbital basis $\{\chi_p(\bm x_q)\}$. A spin-orbital is typically written as a product of a spatial part and a spin part, e.g. $\chi(\bm x) = \phi(\bm r)\omega(\sigma)$.

Given such a finite spin-orbital basis of size $2M$ ($M$ spatial orbitals with 2 different spins each), the \gls{SD} expansion is also finite. Therefore, we may write $\hat H$ as a square matrix and equation \eqref{eq:elec_hamiltonian_2q} as an eigenvalue equation,
\begin{equation}
\label{eq:eval_eqn}
\hat H\Psi = E\Psi.
\end{equation}

Note, however, that in order to make this a finite-dimensional matrix eigenvalue problem, we needed to use a finite spin-orbital basis. Thus, $E$ in equation \eqref{eq:eval_eqn} is not the true ground state energy of the system, but indeed only an approximation within that basis set. This is the case even if we were to solve equation \eqref{eq:eval_eqn} exactly. In order to get the true ground state energy, we need to reach the \gls{CBS}, i.e. $M\to\infty$.

With \eqref{eq:eval_eqn}, we have transformed the hopelessly intractible partial differential equation \eqref{eq:theory_of_everything} into a finite algebraic eigenvalue problem, which is much better suited for solving on a computer.

If we have $N_\uparrow$ spin-up electrons and $N_\downarrow$ spin-down electrons, we then have
\begin{equation}
\label{eq:scaling}
|\mathcal{H}| = {M \choose N_\uparrow}{M\choose N_\downarrow}
\end{equation}
where $|\mathcal{H}|$ denotes the size of the Hilbert space, and we have assumed that the number of spin-up orbitals $M$ is equal to the number of spin-down orbitals. Here, ${n\choose r}=\frac{n!}{r!(n-r)!}$ is a binomial coefficient.

The combinatorial scaling is still unfavourable. For a closed-shell system with 20 electrons in 20 orbitals, $|\mathcal{H}|=3.41\times 10^{10}$. Assuming we wish to have double precision,\footnote{A double precision floating-point number has 1 bit for the sign, 11 bits for the exponent, and 52 bits for fraction (known as the mantissa).\cite{ascherFirst2011} This resolves to 64 bits or 8 bytes.} to store the whole matrix we would need about $10^{23}$ bytes, or 100 zettabytes. So, while we've substantially reduced the complexity of the problem, it is still extremely demanding. More approximations are therefore needed.

\subsection{Orbitals}
\label{sec:orbitals}

Orbitals (and spin-orbitals), a term already used in this text, describes the spatial destribution (and in the case of spin-orbitals, also the spin) of a single electron. We assume that spatial orbitals form an orthonormal set, and that they form a complete space for an arbitrary wave function. However, in practice to have a \gls{CBS} would mean needing an infinite number of basis functions. In practice, we must of course have a finite basis, and so this naturally leads to a hierarchy of basis sets, where the typically larger basis sets are both more expensive and more accurate.

Many different basis set families exist, but among the most popular are those due to Dunning and coworkers.\todo{cite dunning, maybe others?} Additionally, many different basis set extrapolation techniques have also been developed.\todo{cite extrapolation techniques}

Strictly speaking, any kind of functions can be used as a basis set, as long as they are a complete set. However, in practice we may broadly categorise them into two groups: \glspl{STO} and \glspl{GTO}.

The exact solution for the Hydrogen atom is the Slater-type function $\frac 1{\sqrt{\pi}} \e^{-r}$, and similarly we know that molecular orbitals also decay as $\sim e^{-\zeta r}$.

However, these \glspl{STO} are difficult to work with, as we integrals of the form
\begin{equation}
    \label{eq:two-body-integral}
\int\d^3r_1\d^3r_2 \phi_P(\bm r_1)\phi_Q^*(\bm r_1)\frac 1 {r_{12}}\phi_R(\bm r_2)\phi_S^*(\bm r_2)
\end{equation}
are routinely needed.

Therefore, \glspl{GTO} have been developed, which have the form $\e^{-\alpha r^2}$. \glspl{GTO} are much easier to handle, as the product of a gaussian is also a gaussian, and the integral of a gaussian is exactly known, so equations like \eqref{eq:two-body-integral} have known solutions. With this comes a tradeoff, since we know \glspl{STO} more faithfully capture the form of molecular orbitals, but \glspl{GTO} are much better for practical purposes. For this, the most common basis sets typically use a linear combination (or ``contraction'') of gaussians fitted to a \gls{STO}. An illustration is shown in figure \ref{fig:sto-gto}.

It must be noted, however, that \glspl{STO} and \glspl{GTO} have different asymptotic behaviour for $r\to\infty$ and $r\to 0$. The latter in particular will be discussed in section \ref{sec:cusp}.

\begin{figure}[htbp]
    \centering

    \caption{Illustration of an $s$-type orbital and the fitted gaussians. Note that for most of the curve, there is good agreement, but not for the short- and long-range. The short-range behaviour in particular leads to complications, and is the focus of the methods discussed in chapter \ref{chap:explicit}. The long-range behaviour is typically less of a problem, since the integrals we are interested in typically decay with $r$. \todo{maybe get the actual parameters for e.g. a 1s orbital? I think this is even given in Szabo/Ostlund}}
    \label{fig:sto-gto}
\end{figure}

\section{The Hartree-Fock Method}
\label{sec:hf}

The typical starting point to most \emph{ab initio} electronic structure methods is the \gls{HF} method.\todo{HF citations} The key approximation in \gls{HF} is that we treat the exact $N$-body wave function solution as approximately a single \gls{SD}.\footnote{More precisely, the \gls{HF} approximation is to treat the wave function as a single configuration. In the context of this dissertation, that configuration will always be a \gls{SD}.} Then, we variationally (see section \ref{sec:variational_principle}) optimise the energy of the system with respect to parameters pertaining to the spin-orbitals. Call this \gls{SD} $\ket{\kappa}$.

Then, for some reference configuration $\ket 0$,\footnote{$P=(p,\sigma)$ are spin-orbital indices, for brevity.}
\begin{equation}
\ket{\Phi_0} = \e^{-\kappa} \ket 0.
\end{equation}
Here,
\begin{equation}
\kappa = \sum_{PQ} \kappa_{PQ}a_P^\dag a_Q
\end{equation}
is an anti-Hermitian ($\kappa_{PQ}^* = -\kappa_{QP}$) operator whose matrix elements $\kappa_{PQ}$ are the orbital rotation coefficients and will be the variational parameters. The anti-Hermiticity of $\kappa$ ensures that the orbital rotation $\e^{-\kappa}$ is unitary.

With $\braket{\Phi_0}=1$, we want
\begin{equation}
E_\mathrm{HF} = \min_{\kappa_{PQ}}\bra{\Phi_0}\hat H\ket{\Phi_0}.
\end{equation}
This is a nonlinear equation, and hence the parameters $\kappa_{PQ}$ must be determined iteratively. Since $\e^{-\kappa}$ is unitary, the orthonormality of the spin-orbitals is preserved, $\bra{\phi_P}\ket{\phi_Q} = \delta_{PQ}$.

The \gls{HF} method can also be understood as a mean-field theory. That is, we treat the $N$-body problem as $N$ one-body problems, where a single electron is in an effective ``averaged'' potential from the other $N-1$ electrons. This effective one-body Hamiltonian is known as the Fock operator,
\begin{equation}
    f = \sum_{PQ} f_{PQ} a_P^\dag a_Q.
\end{equation}

The Fock operator $f$ may be written as
\begin{equation}
    f = h + V_\mathrm{eff}
\end{equation}
where the Fock potential's matrix elements are $V_{\mathrm{eff},PQ}=\sum_{I\in\mathrm{occ}}(V_{PQII}-V_{PIIQ})$.

The Hartree-Fock orbitals, which ultimately dictate the parameters for the minimisation procedure, are determined by diagonalising the Fock matrix,
\begin{equation}
    f_{PQ} = \epsilon_P\delta_{PQ}
\end{equation}
where the eigenvalues $\epsilon_P$ are known as the orbital energies.

Since $f$ itself depends on which of the orbitals are occupied, the solution must be determined self-consistently. Hence \gls{HF} is often referred to as a \gls{SCF} method.

Often, the orbitals for the $\uparrow$ and $\downarrow$ electrons are restricted to be the same. This is known as the \gls{RHF} method. Otherwise, we might instead use the \gls{UHF} method, where they are treated independently. However, since this breaks spin symmetry, we might have spin contamination. \gls{ROHF} is a variant that can treat open-shell systems which \gls{RHF} otherwise would not be able to treat while remaining an eigenstate of the $S^2$ (total spin) operator.

\subsection{Correlation Energy}

The correlation energy (for a given basis set) is defined as the difference between the exact energy and the \gls{HF} energy,
\begin{equation}
E_\mathrm{corr} = E_\mathrm{exact} - E_\mathrm{HF}.
\end{equation}
It should be noted, however, that despite this name the \gls{HF} method captures Pauli exchange, and hence does actually correlate electrons. Nevertheless, we typically neglect this when we speak of ``electron correlation''.

\subsection{The Roothaan-Hall Equations}

\todo{... Is this section necessary?}

\section{Post-Hartree-Fock Methods}
\label{sec:post-hf}

While the \gls{HF} method is convenient and can be used efficiently to solve for hundreds of electrons, it is oftentimes not sufficient to describe the electronic structure of a molecule. To account for the remaining correlation, numerous post-Hartree-Fock methods (that is, methods run after \gls{HF}) have been formulated, some of which are ribed in this section.

Correlation energy is typically categorised as either dynamical or static, although their effects are not mutually exclusive and sometimes their difference can be hazy.

Dynamical correlation is remaining correlation that arises due to the instantaneous repulsion from the motion (dynamics) of the electrons.

Static correlation, on the other hand, is related to the degeneracy or near-degeneracy of configurations. In general, to accurately describe a system with strong static correlation, a so-called multi-reference method is needed. As will be seen in chapter \ref{chap:binding}, static correlation plays a big role for molecules at dissociation.

We therefore have two ``axes'' on which to approach the exact solution to equation \eqref{eq:elec_hamiltonian_2q}:
\begin{itemize}
    \item The basis set chosen, where going to a larger basis set (in a systematic way) improves the result, e.g. cc-pVDZ to cc-pVTZ to cc-pVQZ, until eventually reaching the \gls{CBS} limit.
    \item The ``hierarchy of theories'' where the more accurate the method, the closer to the \gls{FCI} limit (discussed below). Many post-Hartree-Fock methods can be systematically improved, for example by considering additional excitations in a coupled cluster method.
\end{itemize}

% For so-called ``weakly-correlated'' electron systems, the \gls{HF} method or a modest improvement thereof is sufficient. However, for ``strongly-correlated'' electron systems, the \gls{HF} method can fail completely, not even describing the system qualitatively correctly.

% \begin{figure}[htbp]
%     \centering

%     \caption{image representing the hierarchy of theories and basis sets}
%     \label{fig:hierarchy}
% \end{figure}

\subsection{Configuration Interaction}
\label{sec:ci}

\gls{CI} is perhaps the most conceptually straightforward post-Hartree-Fock method. Instead of using a single \gls{SD}, we approximate the wave function as a linear combination of \glspl{SD}. That is,
\begin{equation}
\ket{\Phi_\mathrm{CI}} = \sum_p c_p\ket{D_p}
\end{equation}
where $\ket{D_p}$ is a \gls{SD}. This may alternatively be written\footnote{We adopt the common notation convention where $i,j,k,...$ denote occupied orbitals and $a,b,c,...$ virtual (or unoccupied) orbitals.}
\begin{equation}
\label{eq:ci}
\ket{\Phi_\mathrm{CI}} = (\one + \sum_{ia}c_i^a\hat a_a^\dag\hat a_i +
\sum_{ijab}c_{ij}^{ab} a_a^\dag a_b^\dag a_i a_j+...)\ket{\Phi_0}
\end{equation}
where the number of terms in the sum depends on how many excitations we consider, i.e. how far we truncate the \gls{CI} expansion. The energy and wave function are then found as the lowest eigenvalue and corresponding eigenvector, respectively, of the Hamiltonian written in the basis of these \glspl{SD}. This can be done, for example, by exact diagonalisation. If all possible excitations are considered, then we have reached the \gls{CBS} limit, and the solution is exact within that basis set.

\begin{figure}[htbp]
    \centering

    \caption{Illustration of different a \gls{RHF} reference and examples of single-, double-, and triple-excitations. The method CISDT, for example, would consider all determinants of the form illustrated.}
    \label{fig:excitations}
\end{figure}

There are some important limitations to this method, however. Perhaps most notable is that the \gls{CI} method is not size consistent. For two noninteracting systems $A$ and $B$, we expect the composite system $A+B$ to have energy equal to the sum of that for $A$ and $B$, i.e. $E_{A+B}=E_A+E_B$. However, within a truncated \gls{CI} method, this is not the case\footnote{Of course, in \gls{FCI} we necessarily have size consistency, since we have the exact solution for the basis set.}, due to the additive ansatz \eqref{eq:ci}.

Additionally, if we wish to go to the \gls{FCI} method and ensure size consistency and accurate results, we once again have bad scaling, as discussed in section \ref{sec:matrix}. However, there exist sparse diagonalisation routines that need not store the entire matrix $H$, such as the Davidson, Lanczos, and Arnoldi (for non-Hermitian $H$) \todo{citations} methods, which target the ground state and need to store only a fraction of the matrix. Still, these scale with the size of the eigenvector, which is still prohibitively expensive for large systems. A more practical approach to reaching \gls{FCI} accuracy will be discussed later in section \ref{sec:fciqmc}, where we discuss the \gls{FCIQMC} algorithm.

\subsection{Multi-Configurational Self-Consistent Field}

\todo{...\ref{sec:core_electrons}}
\todo{add a figure of CAS}

\subsection{Perturbation Theory}

\subsubsection{Rayleigh-Schr\"odinger}

\subsubsection{M{\o}ller-Plesset}

\subsection{Coupled Cluster Theory}

\subsubsection{Distinguishable Cluster Theory}

% \subsection{Density Matrix Renormalisation Group}

\todo{DMRG?}


% introduction and context
% The quantum many-body problem, the TISE, in principle have everything but it's exceedingly difficult in practice, strong vs weak correlation, need for interesting materials and even small molecules to understand e.g. Haber-Bosch process and nitrogen fixation, mention multiscale methods (see Mona's notes?)
% scope of the thesis
% electronic structure theory
% "all models are wrong, but some of them are useful" (G. E. P. Box, N. R. Draper)
% Model Hamiltonians (Ashcrof & Mermin)
% Hartree-Fock Theory
% correlation energies static vs dynamic, explicit correlation
% post-HF methods

% small preface about the work, publication(s)

% \one
