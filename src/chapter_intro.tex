\chapter{Introduction}
\label{chap:intro}

According to modern quantum theory, to fully describe\footnote{This neglects relavistic effects.} a system of $N_A$ atoms and $N_e$ electrons, we must solve the time-dependent Schr\"odinger equation,
\begin{equation}
    \label{eq:schrodinger}
    i \hbar \frac{\partial}{\partial t} \Psi(\bm{x}, t)
    = \hat{H} \Psi(\bm{x}, t)
\end{equation}
where $x=(\bm{x}, \sigma)$, $\bm r\in\mathcal{R}^{3(N_e+N_A)}$ is the spatial coordinates, and $\sigma$ are the corresponding spins. For atoms with atomic numbers $Z_I$ (positive charge $Ze$), and with $N_e=ZN_A$, the Hamiltonian operator $\hat H$ may be written

\begin{align}
\begin{split}
\label{eq:theory_of_everything}
\hat H =& -\sum_{I=1}^{N_A}\frac{\hbar^2}{2m_I} \nabla^2_I
+ \frac 1{4\pi\epsilon_0} \frac 12\sum_{I,J=1;I\neq J}^{N_A} \frac{Z_IZ_Je^2}{|\bm R_I-\bm R_J|} \\
&- \sum_{i=1}^{N_e} \frac{\hbar^2}{2m_e} \nabla^2_i
+ \frac 1{4\pi\epsilon_0} \frac 12\sum_{i,j=1;i\neq j}^{N_e} \frac{e^2}{|\bm r_i-\bm r_j|}
- \sum_{i=1}^{N_e} \sum_{I=1}^{N_A} \frac{Z_I e^2}{|\bm r_i-\bm R_I|}
\end{split}
\end{align}
where we have represented the nuclear coordinates by $\bm R_I$ and the electron coordinates by $\bm r_i$.

Since quantum chemistry and condensed matter sciences are in general concerned with nonrelativistic processes involving electrons and nuclei, this might be called the \emph{theory of everything}. Hence, we may be tempted to conclude this dissertation early, but in practice the evaluation of the Hamiltonian \eqref{eq:theory_of_everything} is impossible. First, there is no closed form solution of \eqref{eq:schrodinger} with this Hamiltonian. Second, numerical evaluation of $\hat H$ is far from trivial.

Let's consider a simple example, the argon atom. Say we want to solve this partial differential equation on a grid. Let's choose a simple, coarse $100\times 100\times 100$ grid. Then \emph{at each time step} we need to store $(100^3)^{23}=10^{138}$ values, corresponding to all the particle positions and the grid. Considering there are ``only'' $\sim 10^{80}$ atoms in the known universe,\cite{rydenIntroduction2017} this is quite a tall order!

This system has only 18 electrons and 18 nuclei, a farcry from the $10^{23}$ or higher number of electrons in a typical condensed matter system, for example. Moreover, we have not taken into account floating point precision, or that we would need to calculate this for possibly many time steps. Clearly, drastic approximations and more sophisticated methods are required.

\section{Overview of the Thesis}

This dissertation fits into the field of nonrelativistic electronic structure theory, the branch of quantum chemistry concerned with the description of electrons and their correlation inside molecules and materials. More specifically, this dissertation focuses on high-accuracy (but often high-cost) \emph{ab initio} methodologies, especially \gls{FCIQMC} and \gls{TC}. As such, we will only be discussing small systems of consisting of only a few atoms, as they are tractible with a full, all-electron treatment with these methods. In principle, these methods should be able to be embedded \todo{embedding citation(s)} into more large-scale calculations using multiscale techniques, but this is outside the scope of my work. Nevertheless, the work herein is focused on methodologies, and not on particular physical systems.

The outline of the dissertation is as thus:
\begin{itemize}
    \item Chapter \ref{chap:intro} (this chapter) provides a basic overview of electronic structure theory methods and some of its principal concepts.
    \item Chapter \ref{chap:qmc} provides a basic introduction to \gls{QMC} and how it relates to \gls{FCIQMC}.
    \item Chapter \ref{chap:explicit} reviews the current works in so-called ``explicitly correlated'' methods, notably the well-established R12/F12 and the recently-reinvigorated \gls{TC}.
    \item Chapter \ref{chap:opt} discusses optimization of Jastrow factors in the context of \gls{TC}.
    \item Chapter \ref{chap:binding} discusses an extension of the methods in the previous chapters to ensure size consistency and success when targeting strongly multi-reference problems.
    \item Chapter \ref{chap:pytchint} provides an overview of the software \pytchint developed in the group for evaluation of \gls{TC} integrals.
    \item Finally, chapter \ref{chap:sumandout} provides a review and an outlook for the field.
\end{itemize}


\section{Principal Approximations}

As discussed, to make any progress in electronic structure theory, we must make use of approximations. Of course, we must always be cautious and suspicious when using these, and make sure they are valid for the systems in question. Thankfully, over the course of the last century, a cornucopia of different approximations have been developed to tackle the Schr\"odinger question, some of which will be discussed in this section.

\subsection{The Born-Oppenheimer Approximation}

The most important approximation used in electronic structure theory is the \gls{BOA}.\cite{bornZur1927} The \gls{BOA} relies on the fact that the nuclei are much heavier than the electrons, with the mass of a single proton being almost 2000 times the mass of an electron. As an intuitive picture, we may think of the nuclei as moving much slower than the electrons, which can adapt themselves to the instantaneous positions of the nuclei. In mathematical terms, this means we can take the total wave function to be a product of its nuclear and electronic components,
\begin{equation}
    \Psi_\mathrm{total} = \Psi_\mathrm{nuc} \Psi_\mathrm{elec}.
\end{equation}

Notice that the first two terms of \eqref{eq:theory_of_everything} are independent of the electronic coordinates and, ipso facto, have no effect on $\Psi_\mathrm{elec}$. This leads to the \emph{electronic Hamiltonian} under the \gls{BOA}, which can be written in atomic units as
\begin{equation}
\label{eq:elec_hamiltonian}
\hat H_\mathrm{elec} = -\sum_{i} \frac{1}{2} \nabla_i^2 - \sum_{i,I} \frac{Z_I}{r_{iI}} + \sum_{i\gt j} \frac{1}{r_{ij}},
\end{equation}
where we have simplified notation by using miniscule roman letters for the electrons and capital roman letters for the nuclei, and $r_{ij}=|\mathbf{r}_i-\mathbf{r}_j|$ and $r_{iI}=|\mathbf{r}_i-\mathbf{R}_I|$.

In the language of second quantisation, equation \eqref{eq:elec_hamiltonian} can be written as
\begin{equation}
\label{eq:elec_hamiltonian_2q}
\hat H_\mathrm{elec} = \sum_{ij\sigma} h_{ij}a_{i\sigma}^\dag a_{j\sigma}+\frac 12 \sum_{ijkl\sigma\tau} g_{ijkl}a_{i\sigma}^\dag a_{j\tau}^\dag a_{k\tau}a_{l\sigma},
\end{equation}
where $\sigma,\tau\in\{\uparrow,\downarrow\}$ are spin indices, and $a_{i\sigma}$ ($a_{i\sigma}^\dag$) is the annihilation (creation) operator for an electron on spin-orbital $i$ with spin $\sigma$. These must obey the anti-commutation relation
\begin{equation}
    \{a_{i\sigma},a_{j\tau}^\dag\}
    \mathdef
    a_{i\sigma}a_{j\tau}^\dag + a_{j\tau}^\dag a_{i\sigma}
    =\delta_{ij}\delta_{\sigma\tau}
\end{equation}
so that the electrons satisfy the Pauli exclusion principle.

In equation \ref{eq:elec_hamiltonian_2q}, $h_{ij}$ is a one-body integral,
\begin{equation}
\label{eq:hij}
h_{ij} = \int \phi_i^*(\mathbf{r})\left(-\frac 12 \nabla^2 - \sum_I \frac{Z_I}{|\mathbf{R}_I-\mathbf r|}\right)\phi_j(\mathbf{r})\mathrm{d}\mathbf{r}
\end{equation}
and $g_{ijkl}$ is a two-body integral,
\begin{equation}
g_{ijkl} = \int \phi_i^*(\mathbf{r})\phi_k^*(\mathbf{r}')\frac{1}{|\mathbf{r}-\mathbf{r}'|}\phi_j(\mathbf{r}')\phi_l(\mathbf{r})\mathrm{d}\mathbf{r}\mathrm{d}\mathbf{r}',
\end{equation}
with a spatial-orbital basis $\{\phi_i(\mathbf{r})\}$.

Finally, to treat the nuclear Hamiltonian, we neglect the first term of equation \eqref{eq:theory_of_everything}, and treat the second term as approximately constant, so $\hat H_\mathrm{nuc} = \sum_{IJ} Z_IZ_Jr_{IJ}$. Thus, we are left with the problem of solving the electronic structure problem, which is the subject of this dissertation.

Note that while chemists and physicists typically talk about the positions of nuclei in a molecule or solid as if they are fixed in place, as will be done in this dissertation, this is really a colloquialism. If the nuclei had an exact position and zero kinetic energy, the \gls{BOA} would, ipso facto, be in direct contradiction of the Heisenberg uncertainty principle. Instead, on the timescale of the electrons, due to the much higher mass of nuclei, in the \gls{BOA} we treat the nuclei as approximately localised in a state in which their motion is much slower than that of the electrons (but, importantly, not zero). This keeps the approximation from being in conflict with the fundamental postulates of quantum theory.

The \gls{BOA} is an immensely practical tool as it substantially simplifies our equations, and in many applications it is an excellent approximation. It will be a fundamental assumption throughout the rest of this dissertation, though it need not always be valid in all of quantum chemistry.

While we have done a lot to drastically reduce the complexity of equation \eqref{eq:theory_of_everything}, equation \eqref{eq:elec_hamiltonian_2q} is still intractible for large system sizes, scaling combinatorially with the size of the Hilbert space, as function of the system size $N_e$ (henceforth $N$), and the basis set size $M$. Hence, in addition to using a smaller basis, we still need extra approximations and sophisticated methodologies.


\subsection{Core Electrons}

In the ground state of a single atom, electrons first occupy the lowest orbitals. The first occupied shells are typically where the electrons are the most tightly bound.\footnote{This neglects symmetries: energy may be higher due to the angular momentum while staying spatially closer to the nucleus.}

Since they tend to be further from the nucleus in an atom, the valence (non-core) electrons are typically the most affected by the introduction of additional atoms in the system. It is therefore often the valence electrons that are most important in chemical systems. For this reason, we sometimes ``freeze'' the core electrons in their respective orbitals, and only correlate the valence electrons.

Similarly, we may also delete virtual orbitals, typically those of high energy, to further reduce the size of the problem. The remaining space is known as an active space, and is the basic idea of the \gls{CAS} methods.

\todo{add a figure of CAS}

\subsection{Model Hamiltonians}

In 1929, the surrealist artist Ren\'e Magritte displayed a now-famous painting of a pipe with the caption \emph{Ceci n'est pas une pipe} (French for ``This is note a pipe''). It was meant to depict the idea that the painting itself is in a way treacherous: it may appear to be a pipe, but you cannot stuff it or smoke from it, as it is a representation of a pipe.

In a similar way, physicists and chemists often use \emph{model Hamiltonians}, which do away with aspects of equation \eqref{eq:theory_of_everything} that are not expected to be relevant to the problem at hand, resulting in new Hamiltonians that may be considered a representation of equation \eqref{eq:theory_of_everything}, much like Magritte's painting.\footnote{We might further argue that all of science can be described this way, as scientific models are always ``mere'' representations of Nature, and is not Nature itself.} Compared to \emph{ab initio} Hamiltonians like equation \eqref{eq:elec_hamiltonian_2q}, model Hamiltonians are generally much simpler, but depend on parameters whose values we may not necessarily know a priori.

The most famous model Hamiltonian is the Hubbard model,\cite{Hubbard1963} most typically used to describe electrons in a periodic lattice, and can be written as
\begin{equation}
\label{eq:hubbard}
\hat H_\mathrm{Hubb} = - \sum_{<i,j>\sigma} t_{ij} a_{j\sigma}^\dag a_{i\sigma} + \sum_i U_in_{i\uparrow}n_{i\downarrow},
\end{equation}
where $<i,j>$ denotes nearest neighbours, $t_{ij}$ (often taken to be constant, $t$) is a parameter called the hopping amplitude, and $U_i$ (often taken to be constant, $U$) is a parameter called the on-site repulsion.

Despite its apparent simplicity, the Hubbard model is a rich model, and has been used to describe a variety of phenomena, from metal-insulator transitions to high-temperature superconductivity. Moreover, it is not always so simple to solve, and has been the subject of much research.\cite{Lieb1968a,liebermannFCIQMC2023}

Let's consider an especially simple version of the model, with only two sites, and open boundary conditions:
\begin{equation}
\label{eq:hubbard_h2}
\hat H_\mathrm{Hubb} = - t\sum_{\sigma}(a_{1\sigma}^\dag a_{2\sigma} + a_{2\sigma}^\dag a_{1\sigma}) + U(n_{1\uparrow}n_{1\downarrow}+n_{2\uparrow}n_{2\downarrow}).
\end{equation}
We could use this as an approximate description of the H$_2$ molecule, where the electrons are restricted to only the lowest 1s orbitals. Compared to \eqref{eq:theory_of_everything}, this is a tremendously easy problem now.

Of course, when solving a problem using a model Hamiltonian, we must be careful in choosing the correct one. In particular, the exact solution to the Hubbard model in one dimension\cite{Lieb1968a} does not appear to be in agreement with the \emph{ab initio} solution of a one-dimensional chain of hydrogen atoms.\cite{Motta2017,Motta2020}

\section{The Schr\"odinger Equation as a Matrix Problem}


Implicit in the operator algebra of the fermionic creation and annihilation operators $a$ and $a^\dag$ in equation \eqref{eq:elec_hamiltonian_2q} is the Pauli exclusion principle: we cannot have two or more fermions occupying identical states. In the context of electronic structure theory and this dissertation, the fermions and states in question are electrons and orbitals, respectively. This handles the antisymmetry requirement of the fermionic wave function, $\hat P_{ij}^\sigma\Psi = -\Psi$, where $\hat P_{ij}^\sigma$ permutes the $i$th and $j$th electrons with spin $\sigma$.

Our wave function can hence by expanded by a linear combination of \glspl{SD},
\begin{equation}
    \label{eq:SD_expansion}
\Psi = \sum_i c_i \ket{D_i},
\quad \text{where } \ket{D_i} =
\frac 1{\sqrt{N!}}\left|
    \begin{matrix}
        \chi_1(\bm x_1) & \chi_1(\bm x_2) & \cdots & \chi_1(\bm x_N)\\
        \chi_2(\bm x_1) & \chi_2(\bm x_2) & \cdots & \chi_2(\bm x_N)\\
        \vdots & \vdots & \ddots & \vdots\\
        \chi_N(\bm x_1) & \chi_N(\bm x_2) & \cdots & \chi_N(\bm x_N)\\
    \end{matrix}
 \right|
\end{equation}
for a spin-orbital basis $\{\chi_p(\bm x_q)\}$. A spin-orbital is typically written as a product of a spatial part and a spin part, e.g. $\chi(\bm x) = \phi(\bm r)\omega(\sigma)$.

Given such a finite spin-orbital basis of size $2M$ ($M$ spatial orbitals with 2 different spins each), the \gls{SD} expansion is also finite.\footnote{The \gls{SD} expansion is finite, but it still scales poorly with system size.} Therefore, we may write $\hat H$ as a square matrix and equation \eqref{eq:elec_hamiltonian_2q} as an eigenvalue equation,
\begin{equation}
\label{eq:eval_eqn}
\hat H\Psi = E\Psi.
\end{equation}

Note, however, that since, in order to make this a finite-dimensional matrix eigenvalue problem, we needed to use a finite spin-orbital basis, $E$ in equation \eqref{eq:eval_eqn} is not the true ground state energy of the system, but indeed only an approximation within that basis set. In order to get the true ground state energy, we need to reach the \gls{CBS}, i.e. $M\to\infty$.

With \eqref{eq:eval_eqn}, we have transformed the wholly intractible partial differential equation \eqref{eq:theory_of_everything} into a finite algebraic eigenvalue problem, which is much better suited for solving on a computer.


\section{The Hartree-Fock Method}


\todo{...}

\section{Post-Hartree-Fock Methods}

\todo{...}
\todo{also discuss static vs dynamic correlation}


% introduction and context
% The quantum many-body problem, the TISE, in principle have everything but it's exceedingly difficult in practice, strong vs weak correlation, need for interesting materials and even small molecules to understand e.g. Haber-Bosch process and nitrogen fixation, mention multiscale methods (see Mona's notes?)
% scope of the thesis
% electronic structure theory
% "all models are wrong, but some of them are useful" (G. E. P. Box, N. R. Draper)
% Model Hamiltonians (Ashcrof & Mermin)
% Hartree-Fock Theory
% correlation energies static vs dynamic, explicit correlation
% post-HF methods

% small preface about the work, publication(s)

% \one
